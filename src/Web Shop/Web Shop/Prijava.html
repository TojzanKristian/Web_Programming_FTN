<!DOCTYPE html>
<html lang="en">

<head>
    <title>Prijava</title>
    <meta charset="utf-8" name="viewport" content="width=device-width" />
    <style>
        body {
            background-image: url("Pictures\\background.jpg");
            background-size: cover;
        }

        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .form {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .nav-link[href=""] {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="Scripts/bootstrap.min.css">
    <script src="Scripts/code.jquery.com_jquery-3.6.0.min.js"></script>
    <script src="Scripts/nav.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#prijavaBtn').click(function () {
                let kIme = $('#korisnickoIme').val();
                let lozinka = $('#lozinka').val();
                let brojac = 0;

                if (kIme.length === 0) {
                    alert('Korisničko ime mora biti popunjeno !');
                    $('#korisnickoIme').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#korisnickoIme').css({ "border-color": "black", "border-width": "1px" });
                }
                if (lozinka.length === 0 || lozinka.length <= 5) {
                    alert('Lozinka mora biti popunjena !');
                    alert('Lozinka treba da sadrži najmanje 6 karaktera !');
                    $('#lozinka').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#lozinka').css({ "border-color": "black", "border-width": "1px" });
                }
                if (brojac != 0) {
                    return;
                }

                $.ajax({
                    url: '/api/korisnici',
                    type: 'GET',
                    data: { 'korisnickoIme': kIme, 'lozinka': lozinka },
                    success: function (result) {
                        $('#korisnickoIme').val('');
                        $('#lozinka').val('');
                        if (result.Data.Uloga === 0) {
                            changePrikazHref("KupacPočetna.html");
                        }
                        if (result.Data.Uloga === 1) {
                            changePrikazHref("ProdavacPočetna.html");
                        }
                        if (result.Data.Uloga === 2) {
                            changePrikazHref("AdminPočetna.html");
                        }
                        alert('Uspešno ste se prijavili !');
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        alert('Greška: ' + xhr.responseText);
                        $('#korisnickoIme').val('');
                        $('#lozinka').val('');
                    }
                });
            });
        });
    </script>
</head>

<body>
    <ul class="nav nav-pills nav-fill">
        <li class="nav-item">
            <a class="nav-link" aria-current="page" href="Početna.html">Početna</a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" href="Prijava.html">Prijava</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="Registracija.html">Registracija</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="prikazLink" href="">Uloga</a>
        </li>
    </ul>
    <br />
    <div class="container">
        <div class="form">
            <h1 style="font-family: 'Times New Roman', sans-serif; font-weight: bold; margin-top: 0;">Prijavljivanje
            </h1>
            <table>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Korisničko ime:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="text" id="korisnickoIme"
                            name="korisnickoIme" maxlength="25" /></td>
                </tr>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Lozinka:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="password" id="lozinka"
                            name="lozinka" maxlength="18" /></td>
                </tr>
                <tr>
                    <td colspan="2" align='center'>
                        <input class="btn btn-outline-primary" id="prijavaBtn"
                            style="font-family: 'Times New Roman', sans-serif; font-weight: bold;" type="submit"
                            value="Prijava" onclick="changePrikazHref()" />
                    </td>
                </tr>
            </table>
        </div>
    </div>
</body>

</html>