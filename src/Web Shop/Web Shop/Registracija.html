<!DOCTYPE html>
<html lang="en">

<head>
    <title>Stranica za registraciju</title>
    <meta charset="utf-8" name="viewport" content="width=device-width" />
    <style>
        body {
            background-image: url("Pictures\\background.jpg");
            background-size: cover;
        }

        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .form {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .nav-link[href=""] {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="Scripts/bootstrap.min.css">
    <script src="Scripts/code.jquery.com_jquery-3.6.0.min.js"></script>
    <script src="Scripts/nav.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#registracijaBtn').click(function () {
                let kIme = $('#korisnickoIme').val();
                let lozinka = $('#lozinka').val();
                let ime = $('#ime').val();
                let prezime = $('#prezime').val();
                let pol = $('#pol').val();
                let email = $('#email').val();
                let datumR = $('#datumRodjenja').val();
                let uloga = $('#uloge').val();
                let brojac = 0;

                if (kIme.length === 0) {
                    alert('Korisničko ime mora biti popunjeno !');
                    $('#korisnickoIme').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#korisnickoIme').css({ "border-color": "black", "border-width": "1px" });
                }
                if (lozinka.length === 0 || lozinka.length <= 5) {
                    alert('Lozinka mora biti popunjena !');
                    alert('Lozinka treba da sadrži najmanje 6 karaktera !');
                    $('#lozinka').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#lozinka').css({ "border-color": "black", "border-width": "1px" });
                }
                if (ime.length === 0 || /\d/.test(ime)) {
                    alert('Ime mora biti popunjeno !');
                    alert('Ime ne sem sadržati brojeve !');
                    $('#ime').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#ime').css({ "border-color": "black", "border-width": "1px" });
                }
                if (prezime.length === 0 || /\d/.test(prezime)) {
                    alert('Prezime mora biti popunjeno !');
                    alert('Prezime ne sem sadržati brojeve !');
                    $('#prezime').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#prezime').css({ "border-color": "black", "border-width": "1px" });
                }
                if (pol.length === 0 || (pol != "muški" && pol != "ženski")) {
                    alert('Pol mora biti popunjen !');
                    alert('Pol može biti samo muški ili ženski !');
                    $('#pol').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#pol').css({ "border-color": "black", "border-width": "1px" });
                }
                if (email.length === 0 || !email.includes("@")) {
                    alert('Email mora biti popunjen !');
                    alert('Email mora da sadrži "@" !');
                    $('#email').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#email').css({ "border-color": "black", "border-width": "1px" });
                }
                if (datumR.length === 0) {
                    alert('Morate odabrati datum rođenja !');
                    $('#datumRodjenja').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#datumRodjenja').css({ "border-color": "black", "border-width": "1px" });
                }
                if (uloga.length === 0) {
                    alert('Morate odabrati ulogu !');
                    $('#uloge').css({ "border-color": "red", "border-width": "3px" });
                    brojac += 1
                }
                else {
                    $('#uloge').css({ "border-color": "black", "border-width": "1px" });
                }
                if (brojac != 0) {
                    return;
                }

                $.ajax({
                    url: "/api/korisnici",
                    type: "POST",
                    data: JSON.stringify({ korisnickoIme: kIme, lozinka: lozinka, ime: ime, prezime: prezime, pol: pol, email: email, datumRodjenja: datumR, uloga: uloga }),
                    contentType: "application/json",
                    success: function (result) {
                        alert("Uspešna registracija! Otvara vam se stranica za prijavu....");
                        $('#korisnickoIme').val('');
                        $('#lozinka').val('');
                        $('#ime').val('');
                        $('#prezime').val('');
                        $('#pol').val('');
                        $('#email').val('');
                        $('#datumRodjenja').val('');
                        $('#uloge').prop('selectedIndex', 0);
                        window.location.href = "Prijava.html";
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        alert("Greška: " + xhr.responseText);
                        $('#korisnickoIme').val('');
                        $('#lozinka').val('');
                        $('#ime').val('');
                        $('#prezime').val('');
                        $('#pol').val('');
                        $('#email').val('');
                        $('#datumRodjenja').val('');
                        $('#uloge').prop('selectedIndex', 0);
                    }
                });
            });
        });
    </script>
</head>

<body>
    <ul class="nav nav-pills nav-fill">
        <li class="nav-item">
            <a class="nav-link" aria-current="page" href="Početna.html">Početna</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="Prijava.html">Prijava</a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" href="Registracija.html">Registracija</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="prikazLink" href="">Uloga</a>
        </li>
    </ul>
    <br />
    <div class="container">
        <div class="form">
            <h1 style="font-family: 'Times New Roman', sans-serif; font-weight: bold; margin-top: 0;">Registracija</h1>
            <table>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Korisničko ime:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="text" id="korisnickoIme"
                            name="korisnickoIme" maxlength="25" /></td>
                </tr>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Lozinka:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="password" id="lozinka"
                            name="lozinka" maxlength="18" /></td>
                </tr>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Ime:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="text" id="ime" name="ime"
                            maxlength="25" /></td>
                </tr>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Prezime:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="text" id="prezime"
                            name="prezime" maxlength="25" /></td>
                </tr>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Pol:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="text" id="pol" name="pol"
                            maxlength="6" /></td>
                </tr>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Email:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="text" id="email" name="email"
                            maxlength="30" /></td>
                </tr>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Datum rođenja:</td>
                    <td><input style="font-family: 'Arial', sans-serif; color: blue" type="date" id="datumRodjenja"
                            name="datumRodjenja" /></td>
                </tr>
                <tr>
                    <td style="font-family: 'Times New Roman', sans-serif; font-weight: bold;">Uloga:</td>
                    <td>
                        <select style="font-family: 'Arial', sans-serif; color: blue" id="uloge" name="uloge">
                            <option style="font-family: 'Arial', sans-serif; color: blue" value="kupac">Kupac</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" align='center'>
                        <input id="registracijaBtn" class="btn btn-outline-primary"
                            style="font-family: 'Times New Roman', sans-serif; font-weight: bold;" type="submit"
                            value="Registracija" />
                    </td>
                </tr>
            </table>
        </div>
    </div>
</body>

</html>